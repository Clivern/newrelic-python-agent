all : setup bin
	bin/buildout -v -v -c `config.guess | sed -e "s/[0-9.]*$$//"`.cfg

setup : virtualenv-env/bin/buildout

virtualenv-src :
	git clone https://github.com/pypa/virtualenv.git virtualenv-src

virtualenv-env : virtualenv-src
	python virtualenv-src/virtualenv.py --no-site-packages virtualenv-env

virtualenv-env/bin/buildout : virtualenv-env
	virtualenv-env/bin/easy_install zc.buildout

bin: downloads
	virtualenv-env/bin/buildout init

downloads :
	mkdir $@

clean :
	$(RM) .installed.cfg
	rm -rf parts
	$(RM) config.log config.status
	rm -rf autom4te.cache

distclean : clean
	rm -rf Makefile buildout.cfg
	rm -rf virtualenv-src virtualenv-env
	rm -rf bin develop-eggs eggs
	rm -rf downloads
