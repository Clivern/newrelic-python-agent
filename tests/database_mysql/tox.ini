[tox]
setupdir = {toxinidir}/../..
#indexserver =
#    default = http://localhost:3141/root/pypi/
envlist =
    py26-mysql-without-extensions,
    py27-mysql-without-extensions,
    py33-mysql-without-extensions,

    py26-mysql-with-extensions,
    py27-mysql-with-extensions,
    py33-mysql-with-extensions,

[pytest]
usefixtures = session_initialization requires_data_collector

[defaults]
deps =
    pytest
    pytest-cov
    WebTest
    mysql-connector-python
setenv =
    PYTHONPATH={toxinidir}/..
    TOX_ENVDIR = {envdir}

[defaults-without-extensions]
setenv =
    {[defaults]setenv}
    NEW_RELIC_EXTENSIONS = false

[defaults-with-extensions]
setenv =
    {[defaults]setenv}
    NEW_RELIC_EXTENSIONS = true

[testenv:py26-mysql-without-extensions]
basepython = python2.6
deps = {[defaults]deps}
install_command =
    pip install --allow-external mysql-connector-python {opts} {packages}
commands = py.test -v []
setenv = {[defaults-with-extensions]setenv}

[testenv:py27-mysql-without-extensions]
basepython = python2.7
deps = {[defaults]deps}
install_command =
    pip install --allow-external mysql-connector-python {opts} {packages}
commands = py.test -v []
setenv = {[defaults-without-extensions]setenv}

[testenv:py33-mysql-without-extensions]
basepython = python3.3
deps = {[defaults]deps}
install_command =
    pip install --allow-external mysql-connector-python {opts} {packages}
commands = py.test -v []
setenv = {[defaults-without-extensions]setenv}

[testenv:py26-mysql-with-extensions]
basepython = python2.6
deps = {[defaults]deps}
install_command =
    pip install --allow-external mysql-connector-python {opts} {packages}
commands = py.test -v []
setenv = {[defaults-with-extensions]setenv}

[testenv:py27-mysql-with-extensions]
basepython = python2.7
deps = {[defaults]deps}
install_command =
    pip install --allow-external mysql-connector-python {opts} {packages}
commands = py.test -v []
setenv = {[defaults-with-extensions]setenv}

[testenv:py33-mysql-with-extensions]
basepython = python3.3
deps = {[defaults]deps}
install_command =
    pip install --allow-external mysql-connector-python {opts} {packages}
commands = py.test -v []
setenv = {[defaults-with-extensions]setenv}
